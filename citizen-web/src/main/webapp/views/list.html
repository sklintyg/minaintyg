<!-- View start -->
<h1 ng-focus="pagefocus" tabindex="0" xmlns="http://www.w3.org/1999/html">
  <span id="inboxHeader" message key="inbox.header"></span>
</h1>

<div class="row">
  <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
    <p>
      <div message key="inbox.description"></div>
    </p>
  </div>
</div>
<div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

    <div mi-spinner label="label.certificatesloading" show-spinner="!doneLoading" show-content="doneLoading && (certificates | unarchived).length>0">
      <div id="certTable">
        <div ng-repeat="cert in certificates | unarchived" class="{{cert.status}}" data-ng-animate="'custom'">
          <div class="certificate">
            <div class="row">
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div id="certificate-{{cert.id}}" class="cert">
                  <div class="cert-titlebar" ng-class="{'cert-cancelled': cert.cancelled}">
                    <a ng-show="!cert.cancelled" ng-click="sendSelected(cert)" ng-href="#link"><img class="cert-icon" alt="" ng-src="/img/{{cert.type | lowercase}}.png" /></a>
                    <img ng-show="cert.cancelled" class="cert-icon" alt="" ng-src="/img/{{cert.type | lowercase}}.png" />
                    <div class="row">
                      <div class="col-xs-7 col-sm-7 col-md-8 col-lg-8">
                        <h2>
                          <a class="cert-title" ng-click="sendSelected(cert)" ng-show="!cert.cancelled" ng-href="#link"> 
                          	<span message key="certificatetypes.{{cert.type | lowercase}}.commonname"></span>&nbsp; 
                          	<span class="cert-titlebar-type">
                          		<span message key="certificatetypes.{{cert.type | lowercase}}.typename"></span>
                          	</span>
                          </a>
                          <span class="cert-title" ng-show="cert.cancelled">
                            <span message key="certificatetypes.{{cert.type | lowercase}}.commonname"></span> - <span message key="certificates.status.cancelledlc"></span>&nbsp;<span class="cert-titlebar-type"><span message key="certificatetypes.{{cert.type | lowercase}}.typename"></span></span>
                          </span>
                        </h2>
                      </div>
                      <div class="col-xs-4 col-sm-4 col-md-3 col-lg-3 issue">
                        <span message key="listtable.headers.issued"></span>&nbsp;<span class="cert-titlebar-value">{{cert.sentDate | date:'longDate'}}</span>
                      </div>
                      <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1 archive">
                        <a  class="glyphicon glyphicon-folder-close white archive-only" id="archiveCertificateBtn-{{cert.id}}" title="{{messageService.getProperty('button.alt.archive')}}" ng-click="openArchiveDialog(cert)">
<!--                           <img alt="{{messageService.getProperty('button.alt.archive')}}" src="/img/archive-icon.gif" /> -->
                        </a>
                      </div>
                    </div>
                  </div>
                  <div class="cert-header">
                    <div class="row" ng-show="cert.cancelled">
                      <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8 header-row">
                        <div class="alert alert-warning">
                          <span message key="inbox.revoked"></span>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8 header-row">
                        <h3 class="tag"><span message key="listtable.headers.issuedby"></span></h3> {{cert.careunitName}}
                      </div>
                      <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                        <h3 class="tag"><span message key="listtable.headers.certperiod"></span></h3> <span id="certificate-period-{{cert.id}}">{{cert.fromDate | date:'longDate'}}&ndash;{{cert.tomDate| date:'longDate'}}</span>
                      </div>
                      <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1"></div>
                    </div>
                    <div class="row">
                      <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8 header-row">
                        <h3 class="tag"><span message key="listtable.headers.latestEvent"></span></h3>
                        <div ng-show="cert.statuses.length>0">
                          {{cert.statuses[0].timestamp | date:'short'}}
                          <span message key="certificates.status.{{cert.statuses[0].type}}"></span>
                          <span ng-show="cert.statuses[0].type == 'SENT'"><span message key="certificates.target.{{cert.statuses[0].target}}"></span></span>
                          <div collapse="isCollapsed">
                            <div ng-repeat="status in cert.statuses" ng-switch on="$index > 0">
                              <div ng-switch-when="true">
                                {{status.timestamp | date:'short'}}
                                <span message key="certificates.status.{{status.type}}"></span>
                                <span ng-show="status.type == 'SENT'"><span message key="certificates.target.{{status.target}}"></span></span><br>
                              </div>
                            </div>
                          </div>
                          <p>
                            <button class="btn-link btn-link-link" ng-show="cert.statuses.length>1" href="#status" ng-click="isCollapsed = !isCollapsed"><span message key="label.status.{{ !isCollapsed }}"></span></button>
                          </p>
                        </div>
                        <span ng-show="cert.statuses.length==0">Ingen</span>
                      </div>
                      <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                        <button id="viewCertificateBtn-{{cert.id}}" class="btn btn-success" ng-show="!cert.cancelled" ng-disabled="cert.cancelled" ng-click="sendSelected(cert)"><span message key="button.show"></span></button>
                      </div>
                      <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            </div>
          <div class="table-bottom" ng-show="(certificates | unarchived).length>0"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row">
	<div id="noCerts" ng-show="doneLoading && (certificates | unarchived).length<1" class="alert alert-info">
		<span message key="error.nocerts"></span>
	</div>
</div>

<!-- Cookie information -->
<div class="row">
  <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
	  <div>
	    Mina intyg anv√§nder kakor. <a ng-click="toggleCookieInfo()">Om Kakor (Cookies)</a>
	  </div>
	  <div ng-show="showCookieInfo" class="cookieinfo">
      <span message key="about.cookies"></span>
	  </div>
  </div>
</div>
